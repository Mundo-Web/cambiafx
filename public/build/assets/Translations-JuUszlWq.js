var w=Object.defineProperty;var b=(t,a,s)=>a in t?w(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;var x=(t,a,s)=>(b(t,typeof a!="symbol"?a+"":a,s),s);import{j as e}from"./FileViewer-CpM0iYLI.js";import{r as o}from"./index-B80Lgev0.js";import{c as F}from"./ReactAppend-CBRQCQGz.js";import{B as E}from"./Base-CNIZEkp0.js";import{C as N}from"./CreateReactScript-Bj11ghWz.js";import{T as S}from"./Table-fNNkvby0.js";import{M as _}from"./Modal-Dyq34CHD.js";import{R as k}from"./ReactAppend-C-tNgxIf.js";import"./sweetalert2.all-Dh0rZL5X.js";import{I as h}from"./InputFormGroup-DZ3W53Mr.js";import{m as v}from"./main-Br9xqDfn.js";import{B as C}from"./Results-B9dLaNz0.js";import{r as y}from"./DxBox-CdMuSyGE.js";import"./index-DO3Aws4m.js";import"./tippy-react.esm-CHhA99mn.js";/* empty css              */import"./Logout-Cj6nvmS-.js";import"./index.esm-CTa_PdWD.js";import"./axios-B4uVmeYG.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./useTranslation-BvL_iu_4.js";import"./Filter-1mRNSgu6.js";/* empty css               */class B extends C{constructor(){super(...arguments);x(this,"path","admin/translations");x(this,"translate",async({group:s,key:c,value:d,lang_id:u})=>{try{const{status:i,result:n}=await v.Fetch(`/api/${this.path}/translate`,{method:"POST",body:JSON.stringify({group:s,key:c,value:d,lang_id:u})});if(!i)throw new Error((n==null?void 0:n.message)||"Error al guardar traducción");return v.Notify.add({icon:"/assets/img/icon.png",title:"Correcto",body:"Traducción guardada exitosamente",type:"success"}),n}catch(i){return v.Notify.add({icon:"/assets/img/icon.png",title:"Error",body:i.message,type:"danger"}),null}})}}const f=new B,O=({data:t,gridRef:a,isTranslationMode:s})=>{console.log("Esta es la data",t);const[c,d]=o.useState(t.value||t.value_base),[u,i]=o.useState(!1),n=o.useRef(null),m=t.value!==null&&t.value!==t.value_base,g=async()=>{try{const p={group:t.group,key:t.key,value:c,lang_id:t.lang_id};console.log("Este es el lang_id",t.lang_id),console.log("Este es el lang default",t.default_lang_id),t.lang_id===t.default_lang_id?await f.save({...p,id:t.id}):await f.translate(p),a.current.dxDataGrid("instance").refresh(),i(!1)}catch{Notify.error("Error al guardar traducción")}};return e.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[!u&&e.jsx("span",{className:"text-nowrap",children:m?e.jsx("i",{className:"fas fa-check text-success"}):e.jsx("i",{className:"fas fa-times text-danger"})}),e.jsx("input",{ref:n,className:"form-control flex-grow-1",value:c,onChange:p=>{d(p.target.value),i(!0)},onFocus:()=>i(!0),onBlur:()=>setTimeout(()=>i(!1),200)}),u&&e.jsx("button",{className:"btn btn-xs btn-soft-primary",onClick:g,children:s?e.jsx("i",{className:"fa fa-language"}):e.jsx("i",{className:"fa fa-pen"})})]})},I=({current_lang_id:t,default_lang_id:a})=>{const s=o.useRef(),c=o.useRef(),d=o.useRef(),u=o.useRef(),i=o.useRef(),n=o.useRef(),[m,g]=o.useState(!1),p=r=>{g(!1),d.current.value="",u.current.value="",i.current.value="",n.current.value="",$(c.current).modal("show")},T=async r=>{r.preventDefault();const l={id:d.current.value||void 0,group:u.current.value,key:i.current.value,value:n.current.value};await f.save(l)&&($(s.current).dxDataGrid("instance").refresh(),$(c.current).modal("hide"))},j=t!==a;return e.jsxs(e.Fragment,{children:[e.jsx(S,{gridRef:s,title:"Traducciones",rest:f,remoteOperations:{paging:!0,filtering:!0,sorting:!0},toolBar:r=>{r.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar",onClick:()=>p()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"group",caption:"Grupo",allowFiltering:!1,filterOperations:["contains"],filterType:"text",cellTemplate:(r,{data:l})=>{r.html(y(e.jsx(e.Fragment,{children:l.group})))}},{dataField:"key",caption:"Clave",allowFiltering:!1,filterOperations:["contains"],filterType:"text",cellTemplate:(r,{data:l})=>{r.html(y(e.jsx(e.Fragment,{children:l.key})))}},{dataField:"value_base",caption:"Valor Español",width:"200px",allowFiltering:!0,filterOperations:["contains"],filterType:"text"},{dataField:"is_translated",caption:"Estado",width:"80px",allowFiltering:!1,filterType:"text",cellTemplate:(r,{data:l})=>{const R=l.value&&l.value!==l.value_base;r.html(y(e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:R?e.jsx("i",{className:"fas fa-check-circle text-success",title:"Traducido"}):e.jsx("i",{className:"fas fa-times-circle text-danger",title:"Sin traducir"})})))},calculateFilterExpression:(r,l)=>r==="traducido"?["is_translated","=",!0]:r==="no traducido"?["is_translated","=",!1]:null},{dataField:"value",caption:j?"Traducción":"Valor",allowFiltering:!1,cellTemplate:(r,{data:l})=>{k(r,e.jsx(O,{data:l,gridRef:s,isTranslationMode:j}))}}],options:{searchPanel:{visible:!0,width:240,placeholder:"Buscar...",highlightSearchText:!0},filterRow:{visible:!0,applyFilter:"auto"},paging:{pageSize:10},pager:{showPageSizeSelector:!0,allowedPageSizes:[10,25,50,100],showInfo:!0}}}),e.jsx(_,{modalRef:c,title:m?"Editar traducción":"Agregar traducción",onSubmit:T,size:"md",children:e.jsxs("div",{className:"row",id:"translations-container",children:[e.jsx("input",{ref:d,type:"hidden"}),e.jsx(h,{eRef:u,label:"Grupo",col:"col-12",required:!0}),e.jsx(h,{eRef:i,label:"Clave",col:"col-6",required:!0}),e.jsx(h,{eRef:n,label:"Valor",col:"col-6",required:!0})]})})]})};N((t,a)=>{F(t).render(e.jsx(E,{...a,title:"Traducciones",children:e.jsx(I,{...a})}))});

var X=Object.defineProperty;var Y=(c,r,o)=>r in c?X(c,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):c[r]=o;var I=(c,r,o)=>(Y(c,typeof r!="symbol"?r+"":r,o),o);import{j as i}from"./RequirementCard-CpM0iYLI.js";import{r as t}from"./index-B80Lgev0.js";import{c as Z}from"./ReactAppend-CBRQCQGz.js";import{B as ee}from"./Base-BG-6Di3L.js";import{r as ie}from"./DxBox-CdMuSyGE.js";import"./sweetalert2.all-Dh0rZL5X.js";import{B as se}from"./Results-DFOKnyj8.js";import{M as re}from"./Modal-DJyFGvYY.js";import{T as te}from"./Table-C3CodGPR.js";import{I as F}from"./ImageFormGroup-BXuoo0kQ.js";import{I as y}from"./InputFormGroup-C5uNEzQG.js";import{D as M}from"./DxButton-CsjWvhyj.js";import{C as ne}from"./CreateReactScript-Bj11ghWz.js";import{R as ce}from"./ReactAppend-C-tNgxIf.js";import{L as oe}from"./Filter-DhMUjbr-.js";import{S as le,D as ae}from"./SelectAPIFormGroupSupport-DC_Yo552.js";import"./index-DO3Aws4m.js";import"./tippy-react.esm-CHhA99mn.js";/* empty css              */import"./Logout-Cj6nvmS-.js";import"./main-Br9xqDfn.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./index.esm-CTa_PdWD.js";import"./axios-B4uVmeYG.js";import"./useTranslation-eU9E4S-_.js";/* empty css               */import"./index-CqrOtH36.js";class me extends se{constructor(){super(...arguments);I(this,"path","admin/services");I(this,"hasFiles",!0)}}const H=new me,L=({feature:c,index:r,onUpdate:o,onRemove:h,type:u,canRemove:w,characteristics:x,benefits:b,addCharacteristic:j,addBenefit:R})=>{const g=(a,C)=>{o(r,a,C)},N=a=>{o(r,"image",a)};return i.jsx("div",{className:"card mb-3",children:i.jsxs("div",{className:"card-body",children:[i.jsxs("div",{className:"row",children:[i.jsxs("div",{className:"col-md-6",children:[i.jsx(y,{label:"Título",value:c.title,onChange:a=>g("title",a.target.value)}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción"}),i.jsx("textarea",{className:"form-control",rows:3,value:c.description,onChange:a=>g("description",a.target.value)})]})]}),i.jsx("div",{className:"col-md-6",children:i.jsx(ae,{label:"Imagen",currentImage:c.image,onChange:N,aspect:16/9})})]}),i.jsxs("div",{className:"d-flex justify-content-between",children:[i.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>h(r),disabled:!w,children:"Eliminar"}),u==="characteristic"&&r===x.length-1||u==="benefit"&&r===b.length-1?i.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:u==="characteristic"?j:R,children:["Agregar"," ",u==="characteristic"?"Característica":"Beneficio"]}):null]})]})})},pe=({brands:c})=>{var G;const r=t.useRef(),o=t.useRef(),h=t.useRef(),u=t.useRef(),w=t.useRef(),x=t.useRef(),b=t.useRef(),j=t.useRef(),R=t.useRef(),g=t.useRef(),N=t.useRef(),a=t.useRef(),C=t.useRef(),B=t.useRef(),[z,E]=t.useState(!1),[D,O]=t.useState(null),[f,S]=t.useState([{title:"",description:"",image:void 0}]),[d,_]=t.useState([{title:"",description:"",image:void 0}]),[U,k]=t.useState(""),T=()=>{S([...f,{title:"",description:"",image:void 0}])},V=t.useCallback((e,s,l)=>{S(v=>{const m=[...v];return m[e]={...m[e],[s]:l},m})},[]),W=e=>{f.length<=1||S(f.filter((s,l)=>l!==e))},A=()=>{_([...d,{title:"",description:"",image:void 0}])},J=t.useCallback((e,s,l)=>{_(v=>{const m=[...v];return m[e]={...m[e],[s]:l},m})},[]),K=e=>{d.length<=1||_(d.filter((s,l)=>l!==e))},P=e=>{e!=null&&e.id?E(!0):E(!1),h.current.value=(e==null?void 0:e.id)??"",u.current.value=(e==null?void 0:e.title)??"",w.current.value=(e==null?void 0:e.category.name)??"",k(e==null?void 0:e.category.name),O(e),x.current.value=(e==null?void 0:e.description)??"",b.current.value=(e==null?void 0:e.how_it_helps)??"",j.current.value=(e==null?void 0:e.description_helps)??"",R.current.value=(e==null?void 0:e.value_proposition)??"",g.current.value=(e==null?void 0:e.innovation_focus)??"",N.current.value=(e==null?void 0:e.customer_relation)??"",a.image.src=`/api/service/media/${(e==null?void 0:e.image)??"undefined"}`,C.image.src=`/api/service/media/${(e==null?void 0:e.image_secondary)??"undefined"}`,B.image.src=`/api/service/media/${(e==null?void 0:e.image_banner)??"undefined"}`,e!=null&&e.characteristics&&S(e.characteristics.map(s=>({title:s.title,description:s.description,image:s.image}))),e!=null&&e.benefits&&_(e.benefits.map(s=>({title:s.title,description:s.description,image:s.image}))),$(o.current).modal("show")},Q=async e=>{e.preventDefault();const s=new FormData,l={id:h.current.value||void 0,title:u.current.value,description:x.current.value,how_it_helps:b.current.value,description_helps:j.current.value,value_proposition:R.current.value,innovation_focus:g.current.value,customer_relation:N.current.value};for(const n in l)s.append(n,l[n]);const v=a.current.files[0];v&&s.append("image",v);const m=C.current.files[0];m&&s.append("image_secondary",m);const q=B.current.files[0];q&&s.append("image_banner",q),f.forEach((n,p)=>{s.append(`characteristics[${p}][title]`,n.title),s.append(`characteristics[${p}][description]`,n.description),n.image&&(n.image.file?s.append(`characteristics[${p}][image]`,n.image.file):typeof n.image=="string"&&s.append(`characteristics[${p}][existing_image]`,n.image))}),d.forEach((n,p)=>{s.append(`benefits[${p}][title]`,n.title),s.append(`benefits[${p}][description]`,n.description),n.image&&(n.image.file?s.append(`benefits[${p}][image]`,n.image.file):typeof n.image=="string"&&s.append(`benefits[${p}][existing_image]`,n.image))}),s.append("category_name",U),await H.save(s)&&($(r.current).dxDataGrid("instance").refresh(),$(o.current).modal("hide"))};return i.jsxs(i.Fragment,{children:[i.jsx(te,{gridRef:r,title:"Servicios",rest:H,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(r.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar nuevo servicio",onClick:()=>P()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"title",caption:"Título",width:"200px"},{dataField:"description",caption:"Descripción",cellTemplate:(e,{data:s})=>{e.html(ie(i.jsx("div",{className:"text-truncate",style:{maxWidth:"300px"},children:s.description})))}},{dataField:"image",caption:"Imagen",width:"100px",cellTemplate:(e,{data:s})=>{ce(e,i.jsx("img",{src:`/api/service/media/${s.image}`,style:{width:"80px",height:"45px",objectFit:"cover",borderRadius:"4px"},onError:l=>l.target.src="/images/default-thumbnail.jpg"}))}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:s})=>{e.append(M({className:"btn btn-xs btn-soft-primary me-1",title:"Editar",icon:"fa fa-pen",onClick:()=>P(s)})),e.append(M({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>onDeleteClicked(s.id)}))}}]}),i.jsxs(re,{modalRef:o,title:z?"Editar Servicio":"Nuevo Servicio",onSubmit:Q,size:"lg",children:[i.jsx("input",{ref:h,type:"hidden"}),i.jsxs("div",{className:"row",id:"service-container",children:[i.jsxs("div",{className:"col-md-6",children:[i.jsx(le,{eRef:w,dropdownParent:"#service-container",label:"Categoría",searchAPI:"/api/admin/category_services/paginate",searchBy:"name",allowCreate:!0,onChange:e=>k(e),initialValue:((G=D==null?void 0:D.category)==null?void 0:G.name)||""}),i.jsx(y,{eRef:u,label:"Título del servicio",required:!0}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción"}),i.jsx("textarea",{ref:x,className:"form-control",rows:4,required:!0})]})]}),i.jsxs("div",{className:"col-md-6",children:[i.jsx(y,{eRef:b,label:"Cómo ayuda"}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción de ayuda"}),i.jsx("textarea",{ref:j,className:"form-control",rows:4})]})]})]}),i.jsxs("div",{className:"row mt-3",children:[i.jsx("div",{className:"col-md-6",children:i.jsx(F,{eRef:a,label:"Imagen principal",aspect:16/9})}),i.jsx("div",{className:"col-md-6",children:i.jsx(F,{eRef:C,label:"Imagen secundaria",aspect:16/9})}),i.jsx("div",{className:"col-md-12 mt-3",children:i.jsx(F,{eRef:B,label:"Banner",aspect:16/9})})]}),i.jsx("div",{className:"row mt-3",children:i.jsxs("div",{className:"col-12",children:[i.jsx(y,{eRef:R,label:"Propuesta de valor"}),i.jsx("h5",{className:"mb-3",children:"Características"}),f.map((e,s)=>i.jsx(L,{feature:e,index:s,onUpdate:V,onRemove:W,canRemove:f.length>1,type:"characteristic",characteristics:f,benefits:d,addCharacteristic:T,addBenefit:A},`char-${s}`))]})}),i.jsxs("div",{className:"row mt-3",children:[i.jsx("div",{className:"col-md-6",children:i.jsx(y,{eRef:g,label:"Enfoque de innovación"})}),i.jsx("div",{className:"col-md-6",children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Relación con el cliente"}),i.jsx("textarea",{ref:N,className:"form-control",rows:5})]})}),i.jsxs("div",{className:"col-md-12",children:[i.jsx("h5",{className:"mb-3 mt-4",children:"Beneficios"}),d.map((e,s)=>i.jsx(L,{feature:e,index:s,onUpdate:J,onRemove:K,canRemove:d.length>1,type:"benefit",characteristics:f,benefits:d,addCharacteristic:T,addBenefit:A},`benefit-${s}`))]})]})]})]})};ne((c,r)=>{Z(c).render(i.jsx(oe,{children:i.jsx(ee,{...r,title:"Servicios",children:i.jsx(pe,{...r})})}))});

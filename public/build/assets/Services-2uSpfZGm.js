var X=Object.defineProperty;var Y=(c,s,a)=>s in c?X(c,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[s]=a;var k=(c,s,a)=>(Y(c,typeof s!="symbol"?s+"":s,a),a);import{j as i}from"./RequirementCard-DEdD30eg.js";import{r as n}from"./index-RYns6xqu.js";import{c as Z}from"./ReactAppend-vpV7VTGG.js";import{B as ee}from"./Base-A6Qjm4oP.js";import{r as ie}from"./DxBox-DZgBbgD6.js";import"./sweetalert2.all-DJo0UVK6.js";import{B as te}from"./Results-BBVbNL2k.js";import{M as se}from"./Modal-IE2ysmSM.js";import{T as re}from"./Table-BTG--uQT.js";import{I as G}from"./ImageFormGroup-D50xykhM.js";import{I as b}from"./InputFormGroup-B7mKwzkx.js";import{D as A}from"./DxButton-CsjWvhyj.js";import{C as oe}from"./CreateReactScript-BuKYEKxn.js";import{R as M}from"./ReactAppend-DPXaoPQG.js";import{S as ne}from"./SwitchFormGroup-SB6Qzl6-.js";import{L as ce}from"./Filter-CpekYgBC.js";import{D as le}from"./DragDropImage-DYciWnuD.js";import"./main-Y8JAyXgE.js";import"./index-CXU7o9CY.js";import"./tippy-react.esm-DYFqe69e.js";/* empty css              */import"./Logout-BlWggqgx.js";import"./index.esm-zkRd-kwu.js";import"./axios-B4uVmeYG.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./useTranslation-CZbMeh78.js";/* empty css               */import"./index-DNUR7M9R.js";class ae extends te{constructor(){super(...arguments);k(this,"path","admin/services");k(this,"hasFiles",!0)}}const I=new ae,E=({feature:c,index:s,onUpdate:a,onRemove:x,type:m,canRemove:j,characteristics:R,benefits:N,addCharacteristic:C,addBenefit:_,addStep:w,steps:y})=>{const f=(p,D)=>{a(s,p,D)},S=p=>{a(s,"image",p)};return i.jsx("div",{className:"card mb-3",children:i.jsxs("div",{className:"card-body",children:[i.jsx("div",{className:"row",children:m==="characteristic"?i.jsx("div",{className:"col-md-12",children:i.jsx(b,{label:"Título",value:c.title,onChange:p=>f("title",p.target.value)})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"col-md-6",children:[i.jsx(b,{label:"Título",value:c.title,onChange:p=>f("title",p.target.value)}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción"}),i.jsx("textarea",{className:"form-control",rows:3,value:c.description,onChange:p=>f("description",p.target.value)})]})]}),i.jsx("div",{className:"col-md-6",children:i.jsx(le,{label:"Imagen",currentImage:c.image,onChange:S,aspect:16/9})})]})}),i.jsxs("div",{className:"d-flex justify-content-between",children:[i.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>x(s),disabled:!j,children:"Eliminar"}),m==="characteristic"&&s===R.length-1||m==="benefit"&&s===N.length-1||m==="step"&&s===y.length-1?i.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:m==="characteristic"?C:m==="benefit"?_:w,children:["Agregar"," ",m==="characteristic"?"Característica":m==="benefit"?"Beneficio":"Paso"]}):null]})]})})},me=({brands:c})=>{const s=n.useRef(),a=n.useRef(),x=n.useRef(),m=n.useRef(),j=n.useRef(),R=n.useRef(),N=n.useRef(),C=n.useRef(),_=n.useRef(),w=n.useRef(),y=n.useRef(),f=n.useRef(),S=n.useRef(),[p,D]=n.useState(!1),[g,B]=n.useState([{title:""}]),[h,F]=n.useState([{title:"",description:"",image:void 0}]),[v,T]=n.useState([{title:"",description:"",image:void 0}]),P=()=>{B([...g,{title:""}])},L=n.useCallback((e,t,r)=>{B(d=>{const l=[...d];return l[e]={...l[e],[t]:r},l})},[]),U=e=>{g.length<=1||B(g.filter((t,r)=>r!==e))},z=()=>{F([...h,{title:"",description:"",image:void 0}])},O=n.useCallback((e,t,r)=>{F(d=>{const l=[...d];return l[e]={...l[e],[t]:r},l})},[]),W=e=>{h.length<=1||F(h.filter((t,r)=>r!==e))},H=()=>{T([...v,{title:"",description:"",image:void 0}])},J=n.useCallback((e,t,r)=>{T(d=>{const l=[...d];return l[e]={...l[e],[t]:r},l})},[]),K=e=>{v.length<=1||T(v.filter((t,r)=>r!==e))},q=e=>{e!=null&&e.id?D(!0):D(!1),x.current.value=(e==null?void 0:e.id)??"",m.current.value=(e==null?void 0:e.name)??"",j.current.value=(e==null?void 0:e.title)??"",R.current.value=(e==null?void 0:e.description)??"",N.current.value=(e==null?void 0:e.title_approach)??"",C.current.value=(e==null?void 0:e.description_approach)??"",_.current.value=(e==null?void 0:e.title_benefits)??"",w.current.value=(e==null?void 0:e.title_methodology)??"",y.current.value=(e==null?void 0:e.description_methodology)??"",f.image.src=`/api/service/media/${(e==null?void 0:e.image)??"undefined"}`,S.image.src=`/api/service/media/${(e==null?void 0:e.image_secondary)??"undefined"}`,e!=null&&e.characteristics_approach&&B(e.characteristics_approach.map(t=>({title:t.title}))),e!=null&&e.benefits&&F(e.benefits.map(t=>({title:t.title,description:t.description,image:t.image}))),e!=null&&e.steps_methodology&&T(e.steps_methodology.map(t=>({title:t.title,description:t.description,image:t.image}))),$(a.current).modal("show")},Q=async e=>{e.preventDefault();const t=new FormData,r={id:x.current.value||void 0,name:m.current.value,title:j.current.value,description:R.current.value,title_approach:N.current.value,description_approach:C.current.value,title_benefits:_.current.value,title_methodology:w.current.value,description_methodology:y.current.value};for(const o in r)t.append(o,r[o]);const d=f.current.files[0];d&&t.append("image",d);const l=S.current.files[0];l&&t.append("image_secondary",l),g.forEach((o,u)=>{t.append(`characteristics[${u}][title]`,o.title)}),h.forEach((o,u)=>{t.append(`benefits[${u}][title]`,o.title),t.append(`benefits[${u}][description]`,o.description),o.image&&(o.image.file?t.append(`benefits[${u}][image]`,o.image.file):typeof o.image=="string"&&t.append(`benefits[${u}][existing_image]`,o.image))}),v.forEach((o,u)=>{t.append(`steps[${u}][title]`,o.title),t.append(`steps[${u}][description]`,o.description),o.image&&(o.image.file?t.append(`steps[${u}][image]`,o.image.file):typeof o.image=="string"&&t.append(`steps[${u}][existing_image]`,o.image))}),await I.save(t)&&($(s.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},V=async({id:e,field:t,value:r})=>{await I.boolean({id:e,field:t,value:r})&&$(s.current).dxDataGrid("instance").refresh()};return i.jsxs(i.Fragment,{children:[i.jsx(re,{gridRef:s,title:"Servicios",rest:I,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(s.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar nuevo servicio",onClick:()=>q()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"title",caption:"Título",width:"200px"},{dataField:"description",caption:"Descripción",cellTemplate:(e,{data:t})=>{e.html(ie(i.jsx("div",{className:"text-truncate",style:{maxWidth:"300px"},children:t.description})))}},{dataField:"image",caption:"Imagen",width:"100px",cellTemplate:(e,{data:t})=>{M(e,i.jsx("img",{src:`/api/service/media/${t.image}`,style:{width:"80px",height:"45px",objectFit:"cover",borderRadius:"4px"},onError:r=>r.target.src="/images/default-thumbnail.jpg"}))}},{dataField:"featured",caption:"Destacado",dataType:"boolean",width:"80px",cellTemplate:(e,{data:t})=>{M(e,i.jsx(ne,{checked:t.featured,onChange:r=>V({id:t.id,field:"featured",value:r.target.checked})}))}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:t})=>{e.append(A({className:"btn btn-xs btn-soft-primary me-1",title:"Editar",icon:"fa fa-pen",onClick:()=>q(t)})),e.append(A({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>onDeleteClicked(t.id)}))}}]}),i.jsxs(se,{modalRef:a,title:p?"Editar Servicio":"Nuevo Servicio",onSubmit:Q,size:"lg",children:[i.jsx("input",{ref:x,type:"hidden"}),i.jsxs("div",{className:"row",id:"service-container",children:[i.jsxs("div",{className:"col-md-6",children:[i.jsx(b,{eRef:m,label:"Nombre del servicio",required:!0}),i.jsx(b,{eRef:j,label:"Título del servicio",required:!0}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción"}),i.jsx("textarea",{ref:R,className:"form-control",rows:4,required:!0})]}),i.jsx(G,{eRef:f,label:"Imagen principal",aspect:16/9}),i.jsx(G,{eRef:S,label:"Icono del servicio",aspect:1})]}),i.jsxs("div",{className:"col-md-6",children:[i.jsx(b,{eRef:N,label:"Título del enfoque",required:!0}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción del enfoque"}),i.jsx("textarea",{ref:C,className:"form-control",rows:4,required:!0})]}),i.jsx("h5",{className:"mb-3 mt-4",children:"Caracteristicas"}),g.map((e,t)=>i.jsx(E,{feature:e,index:t,onUpdate:L,onRemove:U,canRemove:g.length>1,type:"characteristic",characteristics:g,addCharacteristic:P},`char-${t}`))]})]}),i.jsxs("div",{className:"row mt-3",children:[i.jsx("div",{className:"col-md-12",children:i.jsx(b,{eRef:w,label:"Título de metodología",required:!0})}),i.jsx("div",{className:"col-md-12",children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Descripción de metodología"}),i.jsx("textarea",{ref:y,className:"form-control",rows:4,required:!0})]})}),i.jsx("h5",{className:"mb-3 mt-4",children:"Paso a paso"}),v.map((e,t)=>i.jsx(E,{feature:e,index:t,onUpdate:J,onRemove:K,canRemove:v.length>1,type:"step",addStep:H,steps:v},`step-${t}`))]}),i.jsx("div",{className:"row mt-3"}),i.jsx("div",{className:"row mt-3",children:i.jsxs("div",{className:"col-md-12",children:[i.jsx("div",{className:"col-md-12",children:i.jsx(b,{eRef:_,label:"Título de beneficios",required:!0})}),i.jsx("h5",{className:"mb-3 mt-4",children:"Beneficios"}),h.map((e,t)=>i.jsx(E,{feature:e,index:t,onUpdate:O,onRemove:W,canRemove:h.length>1,type:"benefit",benefits:h,addBenefit:z},`benefit-${t}`))]})})]})]})};oe((c,s)=>{Z(c).render(i.jsx(ce,{children:i.jsx(ee,{...s,title:"Servicios",children:i.jsx(me,{...s})})}))});

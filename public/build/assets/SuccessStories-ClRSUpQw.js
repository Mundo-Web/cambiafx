var le=Object.defineProperty;var ce=(u,i,p)=>i in u?le(u,i,{enumerable:!0,configurable:!0,writable:!0,value:p}):u[i]=p;var L=(u,i,p)=>(ce(u,typeof i!="symbol"?i+"":i,p),p);import{j as s}from"./RequirementCard-DEdD30eg.js";import{r as t}from"./index-RYns6xqu.js";import{c as oe}from"./ReactAppend-vpV7VTGG.js";import{B as ue}from"./Base-y8M33DP0.js";import{r as me}from"./DxBox-DZgBbgD6.js";import"./sweetalert2.all-DJo0UVK6.js";import{M as ae}from"./Modal-IE2ysmSM.js";import{T as pe}from"./Table-2QPfgvI2.js";import{I as P}from"./ImageFormGroup-D50xykhM.js";import{I as o}from"./InputFormGroup-B7mKwzkx.js";import{D as H}from"./DxButton-CsjWvhyj.js";import{C as fe}from"./CreateReactScript-DsAnrELU.js";import{R as de}from"./ReactAppend-DPXaoPQG.js";import{L as ge}from"./Filter-CpekYgBC.js";import{D as he}from"./DragDropImage-DYciWnuD.js";import"./main-BRgt_Qdg.js";import{B as be}from"./Results-JAW5vFDV.js";import"./index-CXU7o9CY.js";import"./tippy-react.esm-DYFqe69e.js";/* empty css              */import"./Logout-CEgeG-T3.js";import"./index.esm-zkRd-kwu.js";import"./axios-B4uVmeYG.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./useTranslation-CZbMeh78.js";/* empty css               */import"./index-DNUR7M9R.js";class xe extends be{constructor(){super(...arguments);L(this,"path","admin/success_stories");L(this,"hasFiles",!0)}}const J=new xe,z=({feature:u,index:i,onUpdate:p,onRemove:j,type:n,canRemove:v,characteristics:R,benefits:_,addCharacteristic:N,addBenefit:y,addStep:C,steps:D,solutions:S,addSolution:w,challenges:q,addChallenge:F})=>{const g=(a,I)=>{p(i,a,I)},B=a=>{p(i,"image",a)};return s.jsx("div",{className:"card mb-3",children:s.jsxs("div",{className:"card-body",children:[s.jsx("div",{className:"row",children:n==="solution"||n==="challenge"?s.jsx("div",{className:"col-md-12",children:s.jsx(o,{label:"Título",value:u.title,onChange:a=>g("title",a.target.value)})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx(o,{label:"Título",value:u.title,onChange:a=>g("title",a.target.value)}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Descripción"}),s.jsx("textarea",{className:"form-control",rows:3,value:u.description,onChange:a=>g("description",a.target.value)})]})]}),s.jsx("div",{className:"col-md-6",children:s.jsx(he,{current:"success_story",label:"Imagen",currentImage:u.image,onChange:B,aspect:16/9})})]})}),s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>j(i),disabled:!v,children:"Eliminar"}),n==="characteristic"&&i===R.length-1||n==="benefit"&&i===_.length-1||n==="step"&&i===D.length-1||n==="challenge"&&i===q.length-1||n==="solution"&&i===S.length-1?s.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:n==="characteristic"?N:n==="benefit"?y:n==="step"?C:n==="challenge"?F:w,children:["Agregar"," ",n==="characteristic"?"Característica":n==="benefit"?"Beneficio":n==="step"?"Paso":n==="challenge"?"Desafío":"Solución"]}):null]})]})})},je=({brands:u})=>{const i=t.useRef(),p=t.useRef(),j=t.useRef(),n=t.useRef(),v=t.useRef(),R=t.useRef(),_=t.useRef(),N=t.useRef(),y=t.useRef(),C=t.useRef(),D=t.useRef(),S=t.useRef(),w=t.useRef(),q=t.useRef(),F=t.useRef(),g=t.useRef(),B=t.useRef(),a=t.useRef(),I=t.useRef(),A=t.useRef(),G=t.useRef(),M=t.useRef(),[K,U]=t.useState(!1),[h,k]=t.useState([{title:""}]),[b,E]=t.useState([{title:""}]),[x,T]=t.useState([{title:"",description:"",image:void 0}]),[ve,Q]=t.useState([{title:"",description:"",image:void 0}]),V=()=>{k([...h,{title:""}])},X=t.useCallback((e,r,l)=>{k(f=>{const c=[...f];return c[e]={...c[e],[r]:l},c})},[]),Y=e=>{h.length<=1||k(h.filter((r,l)=>l!==e))},Z=()=>{E([...b,{title:""}])},ee=t.useCallback((e,r,l)=>{E(f=>{const c=[...f];return c[e]={...c[e],[r]:l},c})},[]),se=e=>{b.length<=1||E(b.filter((r,l)=>l!==e))},re=()=>{T([...x,{title:"",description:"",image:void 0}])},te=t.useCallback((e,r,l)=>{T(f=>{const c=[...f];return c[e]={...c[e],[r]:l},c})},[]),ie=e=>{x.length<=1||T(x.filter((r,l)=>l!==e))};t.useCallback((e,r,l)=>{Q(f=>{const c=[...f];return c[e]={...c[e],[r]:l},c})},[]);const O=e=>{e!=null&&e.id?U(!0):U(!1),j.current.value=(e==null?void 0:e.id)??"",n.current.value=(e==null?void 0:e.name)??"",v.current.value=(e==null?void 0:e.summary)??"",R.current.value=(e==null?void 0:e.description)??"",_.current.value=(e==null?void 0:e.title_benefits)??"",N.current.value=(e==null?void 0:e.description_benefits)??"",y.current.value=(e==null?void 0:e.title_challenges)??"",C.current.value=(e==null?void 0:e.description_challenges)??"",D.current.value=(e==null?void 0:e.category_project)??"",S.current.value=(e==null?void 0:e.client_project)??"",w.current.value=(e==null?void 0:e.date_start_project)??"",q.current.value=(e==null?void 0:e.date_end_project)??"",F.current.value=(e==null?void 0:e.duration)??"",g.current.value=(e==null?void 0:e.company_name)??"",a.current.value=(e==null?void 0:e.company_summary)??"",I.current.value=(e==null?void 0:e.company_percentage)??"",A.current.value=(e==null?void 0:e.company_description_percentage)??"",G.image.src=`/api/success_story/media/${(e==null?void 0:e.image)??"undefined"}`,B.image.src=`/api/success_story/media/${(e==null?void 0:e.company_logo)??"undefined"}`,M.image.src=`/api/success_story/media/${(e==null?void 0:e.image_challenges)??"undefined"}`,e!=null&&e.benefits&&T(e.benefits.map(r=>({title:r.title,description:r.description,image:r.image}))),e!=null&&e.challenges&&k(e.challenges.map(r=>({title:r.title}))),e!=null&&e.solutions&&E(e.solutions.map(r=>({title:r.title}))),$(p.current).modal("show")},ne=async e=>{e.preventDefault();const r=new FormData,l={id:j.current.value||void 0,name:n.current.value,summary:v.current.value,description:R.current.value,title_challenges:y.current.value,description_challenges:C.current.value,title_benefits:_.current.value,description_benefits:N.current.value,category_project:D.current.value,client_project:S.current.value,date_start_project:w.current.value,date_end_project:q.current.value,duration:F.current.value,company_name:g.current.value,company_summary:a.current.value,company_percentage:I.current.value,company_description_percentage:A.current.value};for(const m in l)r.append(m,l[m]);const f=G.current.files[0];f&&r.append("image",f);const c=B.current.files[0];c&&r.append("company_logo",c);const W=M.current.files[0];W&&r.append("image_challenges",W),x.forEach((m,d)=>{r.append(`benefits[${d}][title]`,m.title),r.append(`benefits[${d}][description]`,m.description),m.image&&(m.image.file?r.append(`benefits[${d}][image]`,m.image.file):typeof m.image=="string"&&r.append(`benefits[${d}][existing_image]`,m.image))}),h.forEach((m,d)=>{r.append(`challenges[${d}][title]`,m.title)}),b.forEach((m,d)=>{r.append(`solutions[${d}][title]`,m.title)}),await J.save(r)&&($(i.current).dxDataGrid("instance").refresh(),$(p.current).modal("hide"))};return s.jsxs(s.Fragment,{children:[s.jsx(pe,{gridRef:i,title:"Casos de éxito",rest:J,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(i.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar nuevo Caso de éxtio",onClick:()=>O()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Título",width:"200px"},{dataField:"description",caption:"Descripción",cellTemplate:(e,{data:r})=>{e.html(me(s.jsx("div",{className:"text-truncate",style:{maxWidth:"300px"},children:r.description})))}},{dataField:"image",caption:"Imagen",width:"100px",cellTemplate:(e,{data:r})=>{de(e,s.jsx("img",{src:`/api/success_story/media/${r.image}`,style:{width:"80px",height:"45px",objectFit:"cover",borderRadius:"4px"},onError:l=>l.target.src="/images/default-thumbnail.jpg"}))}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:r})=>{e.append(H({className:"btn btn-xs btn-soft-primary me-1",title:"Editar",icon:"fa fa-pen",onClick:()=>O(r)})),e.append(H({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>onDeleteClicked(r.id)}))}}]}),s.jsxs(ae,{modalRef:p,title:K?"Editar Caso de éxito":"Nuevo Caso de éxito",onSubmit:ne,size:"xl",children:[s.jsx("input",{ref:j,type:"hidden"}),s.jsxs("div",{className:"row",id:"service-container",children:[s.jsxs("div",{className:"col-md-3",children:[s.jsxs("div",{className:"bg-light p-3 rounded mb-4",children:[s.jsx(o,{eRef:D,label:"Categoría del proyecto",required:!0}),s.jsx(o,{eRef:S,label:"Cliente del proyecto",required:!0}),s.jsx(o,{eRef:w,label:"Fecha de inicio del proyecto",type:"date",required:!0}),s.jsx(o,{eRef:q,label:"Fecha de finalización del proyecto",type:"date",required:!0}),s.jsx(o,{eRef:F,label:"Duración del proyecto",type:"text",required:!0})]}),s.jsxs("div",{className:"bg-light p-3 rounded",children:[s.jsx(P,{eRef:B,label:"Logo de la empresa",aspect:16/9}),s.jsx(o,{eRef:g,label:"Nombre de la empresa",required:!0}),s.jsx(o,{eRef:a,label:"Resumen de la empresa",required:!0}),s.jsx(o,{eRef:I,label:"Porcentaje de éxito",type:"number",required:!0}),s.jsx(o,{eRef:A,label:"Descripción del porcentaje de éxito",required:!0})]})]}),s.jsxs("div",{className:"col-md-9",children:[s.jsx(P,{eRef:G,label:"Imagen principal",aspect:16/9}),s.jsx(o,{eRef:n,label:"Nombre del Caso de éxtio",required:!0}),s.jsx(o,{eRef:v,label:"Resumen del Caso de éxtio",required:!0}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Descripción"}),s.jsx("textarea",{ref:R,className:"form-control",rows:4,required:!0})]}),s.jsx("div",{className:"row mt-3",children:s.jsxs("div",{className:"col-md-12",children:[s.jsxs("div",{className:"col-md-12",children:[s.jsx(o,{eRef:_,label:"Título de beneficios",required:!0}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Descripción de beneficios"}),s.jsx("textarea",{ref:N,className:"form-control",rows:4,required:!0})]})]}),s.jsx("h5",{className:"mb-3 mt-4",children:"Beneficios"}),x.map((e,r)=>s.jsx(z,{feature:e,index:r,onUpdate:te,onRemove:ie,canRemove:x.length>1,type:"benefit",benefits:x,addBenefit:re},`benefit-${r}`))]})}),s.jsxs("div",{className:"row mt-4 bg-primary p-2 rounded mb-4",children:[s.jsxs("div",{className:"col-md-8 ",children:[s.jsx(o,{eRef:y,label:"Título del desafío",required:!0}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Descripción del desafío"}),s.jsx("textarea",{ref:C,className:"form-control",rows:4,required:!0})]}),s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("h5",{className:"mb-3 mt-4",children:"Soluciones"}),b.map((e,r)=>s.jsx(z,{feature:e,index:r,onUpdate:ee,onRemove:se,canRemove:b.length>1,type:"solution",solutions:b,addSolution:Z},`char-${r}`))]}),s.jsxs("div",{className:"col-md-6",children:[s.jsx("h5",{className:"mb-3 mt-4",children:"Desafíos"}),h.map((e,r)=>s.jsx(z,{feature:e,index:r,onUpdate:X,onRemove:Y,canRemove:h.length>1,type:"challenge",challenges:h,addChallenge:V},`char-${r}`))]})]})]}),s.jsx("div",{className:"col-md-4",children:s.jsx(P,{eRef:M,label:"Imagen del desafío",aspect:9/16})})]})]})]})]})]})};fe((u,i)=>{oe(u).render(s.jsx(ge,{children:s.jsx(ue,{...i,title:"Casos de éxito",children:s.jsx(je,{...i})})}))});
